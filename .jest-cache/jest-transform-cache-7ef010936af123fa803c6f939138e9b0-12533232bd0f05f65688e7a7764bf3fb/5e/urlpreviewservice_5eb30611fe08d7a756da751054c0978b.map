{"version":3,"names":["cov_22qo1ggumx","actualCoverage","common_1","s","require","open_graph_scraper_1","__importDefault","UrlPreviewService","UrlPreviewService_1","logger","Logger","name","fetchMetadata","url","f","result","default","timeout","title","b","ogTitle","twitterTitle","description","ogDescription","twitterDescription","image","ogImage","twitterImage","siteName","ogSiteName","error","message","exports","__decorate","Injectable"],"sources":["D:\\Latihan\\Programming\\Dummy-Project\\url-shortener\\src\\modules\\url\\url-preview.service.ts"],"sourcesContent":["import { Injectable, Logger } from '@nestjs/common';\r\nimport ogs from 'open-graph-scraper';\r\n\r\n/* \r\nURL Preview Service - fetch open graph metadata from URLs\r\n*/\r\n@Injectable()\r\nexport class UrlPreviewService {\r\n  private readonly logger = new Logger(UrlPreviewService.name);\r\n\r\n  /* \r\n    Fetch open graph metadata\r\n    */\r\n  async fetchMetadata(url: string): Promise<{\r\n    title: string | null;\r\n    description: string | null;\r\n    image: string | null;\r\n    siteName: string | null;\r\n  }> {\r\n    try {\r\n      const { result } = await ogs({ url, timeout: 5000 });\r\n\r\n      return {\r\n        title: result.ogTitle || result.twitterTitle || null,\r\n        description: result.ogDescription || result.twitterDescription || null,\r\n        image: result.ogImage?.[0].url || result.twitterImage?.[0].url || null,\r\n        siteName: result.ogSiteName || null,\r\n      };\r\n    } catch (error) {\r\n      this.logger.error(\r\n        `Failed to fetch metadata for ${url}: ${error.message}`,\r\n      );\r\n      return {\r\n        title: null,\r\n        description: null,\r\n        image: null,\r\n        siteName: null,\r\n      };\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}