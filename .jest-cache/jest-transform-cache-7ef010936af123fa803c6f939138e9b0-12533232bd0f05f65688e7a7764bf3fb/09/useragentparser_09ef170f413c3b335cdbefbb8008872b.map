{"version":3,"names":["cov_1gk5ww040w","actualCoverage","common_1","s","require","ua_parser_js_1","UserAgentParser","parse","userAgent","f","b","browser","browserVersion","os","osVersion","deviceType","parser","UAParser","result","getResult","name","version","getDeviceType","device","type","mobileOS","includes","botKeywords","ua","toLowerCase","some","keyword","exports","__decorate","Injectable"],"sources":["D:\\Latihan\\Programming\\Dummy-Project\\url-shortener\\src\\modules\\analytics\\utils\\user-agent.parser.ts"],"sourcesContent":["import { Injectable } from '@nestjs/common';\r\nimport { UAParser } from 'ua-parser-js';\r\n\r\n/* \r\nUser Agent Parser - Extract device info from user agent\r\n*/\r\n@Injectable()\r\nexport class UserAgentParser {\r\n  parse(userAgent: string): {\r\n    browser: string | null;\r\n    browserVersion: string | null;\r\n    os: string | null;\r\n    osVersion: string | null;\r\n    deviceType: string | null;\r\n  } {\r\n    if (!userAgent) {\r\n      return {\r\n        browser: null,\r\n        browserVersion: null,\r\n        os: null,\r\n        osVersion: null,\r\n        deviceType: null,\r\n      };\r\n    }\r\n\r\n    const parser = new UAParser(userAgent);\r\n    const result = parser.getResult();\r\n\r\n    return {\r\n      browser: result.browser?.name || null,\r\n      browserVersion: result.browser?.version || null,\r\n      os: result.os?.name || null,\r\n      osVersion: result.os?.version || null,\r\n      deviceType: this.getDeviceType(result),\r\n    };\r\n  }\r\n\r\n  private getDeviceType(result: UAParser.IResult): string | null {\r\n    if (result.device.type === 'mobile') return 'mobile';\r\n    if (result.device.type === 'tablet') return 'tablet';\r\n    if (result.device.type === 'smarttv') return 'tv';\r\n    if (result.device.type === 'wearable') return 'wearable';\r\n    if (result.device.type === 'console') return 'console';\r\n\r\n    const mobileOS = ['Android', 'iOS', 'Windows Phone', 'BlackBerry'];\r\n    if (result.os.name && mobileOS.includes(result.os.name)) {\r\n      return 'mobile';\r\n    }\r\n\r\n    // Check for bot/crawler\r\n    const botKeywords = ['bot', 'crawler', 'spider', 'scraper'];\r\n    const userAgent = result.ua.toLowerCase();\r\n    if (botKeywords.some((keyword) => userAgent.includes(keyword))) {\r\n      return 'bot';\r\n    }\r\n\r\n    // Default to desktop\r\n    return 'desktop';\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}