{"version":3,"names":["common_1","cov_1sdav8jbjj","s","require","swagger_1","rate_limit_decorator_1","rate_limit_guard_1","jwt_auth_guard_1","roles_decorator_1","roles_guard_1","user_entity_1","admin_service_1","AdminController","adminService","constructor","f","getSystemStats","getRecentActivity","limit","b","getDetailedHealt","status","timestamp","Date","toISOString","uptime","process","memory","memoryUsage","exports","__decorate","ApiOperation","summary","ApiResponse","description","ApiBearerAuth","Get","__param","Query","ParseIntPipe","optional","ApiTags","Controller","UseGuards","RateLimitGuard","JwtAuthGuard","RolesGuard","Roles","UserRole","ADMIN","RateLimit","ttl","max","AdminService","_a","Object"],"sources":["D:\\Latihan\\Programming\\Dummy-Project\\url-shortener\\src\\modules\\admin\\admin.controller.ts"],"sourcesContent":["import {\r\n  Injectable,\r\n  Get,\r\n  Query,\r\n  ParseIntPipe,\r\n  UseGuards,\r\n  Controller,\r\n} from '@nestjs/common';\r\nimport {\r\n  ApiTags,\r\n  ApiOperation,\r\n  ApiResponse,\r\n  ApiBearerAuth,\r\n} from '@nestjs/swagger';\r\n\r\nimport { RateLimit } from '../rate-limit/decorators/rate-limit.decorator';\r\nimport { RateLimitGuard } from '../rate-limit/guards/rate-limit.guard';\r\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\r\nimport { Roles } from '../auth/decorators/roles.decorator';\r\nimport { RolesGuard } from '../auth/guards/roles.guard';\r\nimport { UserRole } from '../auth/entities/user.entity';\r\nimport { AdminService } from './admin.service';\r\n\r\n/* \r\nAdmin Controller - admin dashboard endpoints\r\n*/\r\n@ApiTags('admin')\r\n@Controller('api/admin')\r\n@UseGuards(RateLimitGuard, JwtAuthGuard, RolesGuard)\r\n@Roles(UserRole.ADMIN)\r\n@RateLimit({ ttl: 60, max: 30 })\r\nexport class AdminController {\r\n  constructor(private readonly adminService: AdminService) {}\r\n\r\n  /* \r\n  Get system statistics\r\n  */\r\n  @ApiOperation({ summary: 'Get system stats' })\r\n  @ApiResponse({ status: 200 })\r\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\r\n  @ApiBearerAuth()\r\n  @Get('stats')\r\n  async getSystemStats() {\r\n    return this.adminService.getSystemStats();\r\n  }\r\n\r\n  /* \r\n  Get recent activity\r\n  */\r\n  @ApiOperation({ summary: 'Get recent activity' })\r\n  @ApiResponse({ status: 200 })\r\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\r\n  @ApiBearerAuth()\r\n  @Get('activity')\r\n  async getRecentActivity(\r\n    @Query('limit', new ParseIntPipe({ optional: true })) limit?: number,\r\n  ) {\r\n    return this.adminService.getRecentActivity(limit || 20);\r\n  }\r\n\r\n  /* \r\n  Health check with detailed info\r\n  */\r\n  @ApiOperation({ summary: 'Healt check' })\r\n  @ApiResponse({ status: 200 })\r\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\r\n  @ApiBearerAuth()\r\n  @Get('health')\r\n  async getDetailedHealt() {\r\n    return {\r\n      status: 'ok',\r\n      timestamp: new Date().toISOString(),\r\n      uptime: process.uptime(),\r\n      memory: process.memoryUsage(),\r\n      // TODO: add db connection check, redis check, queue health\r\n    };\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}