{"file":"D:\\Latihan\\Programming\\Dummy-Project\\url-shortener\\src\\modules\\auth\\strategies\\jwt.strategy.ts","mappings":";;;;;;;;;;;;;AAAA,2CAAmE;AACnE,+CAAoD;AACpD,+CAAoD;AACpD,2CAA+C;AAE/C,kDAA8C;AAE9C;;EAEE;AAEK,IAAM,WAAW,GAAjB,MAAM,WAAY,SAAQ,IAAA,2BAAgB,EAAC,uBAAQ,CAAC;IAEtC;IACA;IAFnB,YACmB,aAA4B,EAC5B,WAAwB;QAEzC,KAAK,CAAC;YACJ,cAAc,EAAE,yBAAU,CAAC,2BAA2B,EAAE;YACxD,gBAAgB,EAAE,KAAK;YACvB,WAAW,EAAE,aAAa,CAAC,GAAG,CAAS,YAAY,CAAE;SACtD,CAAC,CAAC;QAPc,kBAAa,GAAb,aAAa,CAAe;QAC5B,gBAAW,GAAX,WAAW,CAAa;IAO3C,CAAC;IAED;;MAEE;IACF,KAAK,CAAC,QAAQ,CAAC,OAAY;QACzB,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAE9D,IAAI,CAAC,IAAI,EAAE,CAAC;YACV,MAAM,IAAI,8BAAqB,EAAE,CAAC;QACpC,CAAC;QAED,OAAO;YACL,EAAE,EAAE,IAAI,CAAC,EAAE;YACX,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,IAAI,EAAE,IAAI,CAAC,IAAI;SAChB,CAAC;IACJ,CAAC;CACF,CAAA;AA5BY,kCAAW;sBAAX,WAAW;IADvB,IAAA,mBAAU,GAAE;yDAGuB,sBAAa,oBAAb,sBAAa,oDACf,0BAAW,oBAAX,0BAAW;GAHhC,WAAW,CA4BvB","names":[],"sources":["D:\\Latihan\\Programming\\Dummy-Project\\url-shortener\\src\\modules\\auth\\strategies\\jwt.strategy.ts"],"sourcesContent":["import { Injectable, UnauthorizedException } from '@nestjs/common';\r\nimport { ExtractJwt, Strategy } from 'passport-jwt';\r\nimport { PassportStrategy } from '@nestjs/passport';\r\nimport { ConfigService } from '@nestjs/config';\r\n\r\nimport { AuthService } from '../auth.service';\r\n\r\n/* \r\nJWT Strategy - validate JWT tokens\r\n*/\r\n@Injectable()\r\nexport class JwtStrategy extends PassportStrategy(Strategy) {\r\n  constructor(\r\n    private readonly configService: ConfigService,\r\n    private readonly authService: AuthService,\r\n  ) {\r\n    super({\r\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\r\n      ignoreExpiration: false,\r\n      secretOrKey: configService.get<string>('JWT_SECRET')!,\r\n    });\r\n  }\r\n\r\n  /* \r\n  Validate JWT payload\r\n  */\r\n  async validate(payload: any) {\r\n    const user = await this.authService.validateUser(payload.sub);\r\n\r\n    if (!user) {\r\n      throw new UnauthorizedException();\r\n    }\r\n\r\n    return {\r\n      id: user.id,\r\n      email: user.email,\r\n      role: user.role,\r\n    };\r\n  }\r\n}\r\n"],"version":3}