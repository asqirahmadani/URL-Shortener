{"version":3,"names":["common_1","cov_1dksmj9qrg","s","require","swagger_1","qrcode_service_1","QrCodeController","qrCodeService","constructor","f","getPNG","shortCode","size","margin","darkColor","lightColor","res","b","BadRequestException","buffer","generatePNG","color","dark","light","send","getSVG","generateSVG","getDataURL","dataURL","generateDataURL","qrCode","exports","__decorate","ApiOperation","summary","ApiResponse","status","description","Get","Header","__param","Param","Query","ParseIntPipe","optional","Res","Promise","_b","Object","_c","_d","Controller","QrCodeService","_a"],"sources":["D:\\Latihan\\Programming\\Dummy-Project\\url-shortener\\src\\modules\\qrcode\\qrcode.controller.ts"],"sourcesContent":["import {\r\n  Controller,\r\n  Get,\r\n  Param,\r\n  Query,\r\n  Res,\r\n  Header,\r\n  ParseIntPipe,\r\n  BadRequestException,\r\n} from '@nestjs/common';\r\nimport type { Response } from 'express';\r\nimport {\r\n  ApiTags,\r\n  ApiResponse,\r\n  ApiOperation,\r\n  ApiBearerAuth,\r\n} from '@nestjs/swagger';\r\n\r\nimport { QrCodeService } from './qrcode.service';\r\n\r\n/* \r\nQR Code Controller - Endpoints for generate QR codes\r\n*/\r\n@Controller('api/qrcode')\r\nexport class QrCodeController {\r\n  constructor(private readonly qrCodeService: QrCodeService) {}\r\n\r\n  /* \r\n  Get QR Code as PNG image\r\n  */\r\n  @ApiOperation({ summary: 'Get QR Code as PNG' })\r\n  @ApiResponse({ status: 200 })\r\n  @ApiResponse({ status: 400, description: 'Bad request' })\r\n  @Get(':shortCode.png')\r\n  @Header('Content-Type', 'image/png')\r\n  @Header('Cache-Control', 'public, max-age=86400')\r\n  async getPNG(\r\n    @Param('shortCode') shortCode: string,\r\n    @Query('size', new ParseIntPipe({ optional: true })) size?: number,\r\n    @Query('margin', new ParseIntPipe({ optional: true })) margin?: number,\r\n    @Query('dark') darkColor?: string,\r\n    @Query('light') lightColor?: string,\r\n    @Res() res?: Response,\r\n  ): Promise<void> {\r\n    // Validate size\r\n    if (size && (size < 100 || size > 2000)) {\r\n      throw new BadRequestException('Size must be between 100 and 2000');\r\n    }\r\n\r\n    const buffer = await this.qrCodeService.generatePNG(shortCode, {\r\n      size,\r\n      margin,\r\n      color: {\r\n        dark: darkColor,\r\n        light: lightColor,\r\n      },\r\n    });\r\n\r\n    res?.send(buffer);\r\n  }\r\n\r\n  /* \r\n  GET QR Code as SVG\r\n  */\r\n  @ApiOperation({ summary: 'Get QR Code as SVG' })\r\n  @ApiResponse({ status: 200 })\r\n  @ApiResponse({ status: 400, description: 'Bad request' })\r\n  @Get(':shortCode.svg')\r\n  @Header('Content-Type', 'image/svg+xml')\r\n  @Header('Cache-Control', 'public, max-age=86400')\r\n  async getSVG(\r\n    @Param('shortCode') shortCode: string,\r\n    @Query('size', new ParseIntPipe({ optional: true })) size?: number,\r\n    @Query('dark') darkColor?: string,\r\n    @Query('light') lightColor?: string,\r\n  ): Promise<string> {\r\n    return this.qrCodeService.generateSVG(shortCode, {\r\n      size,\r\n      color: {\r\n        dark: darkColor,\r\n        light: lightColor,\r\n      },\r\n    });\r\n  }\r\n\r\n  /* \r\n  GET QR Code as URL data (JSON response)\r\n  */\r\n  @ApiOperation({ summary: 'Get QR Code as URL data (JSON)' })\r\n  @ApiResponse({ status: 200 })\r\n  @ApiResponse({ status: 400, description: 'Bad request' })\r\n  @Get(':shortCode')\r\n  async getDataURL(\r\n    @Param('shortCode') shortCode: string,\r\n    @Query('size', new ParseIntPipe({ optional: true })) size?: number,\r\n    @Query('dark') darkColor?: string,\r\n    @Query('light') lightColor?: string,\r\n  ): Promise<{ qrCode: string; shortCode: string }> {\r\n    const dataURL = await this.qrCodeService.generateDataURL(shortCode, {\r\n      size,\r\n      color: {\r\n        dark: darkColor,\r\n        light: lightColor,\r\n      },\r\n    });\r\n\r\n    return {\r\n      qrCode: dataURL,\r\n      shortCode,\r\n    };\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}